(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,324467,8392,e=>{"use strict";var a=e.i(383206);let r=(0,a.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);e.s(["Minus",()=>r],324467);let l=(0,a.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);e.s(["Info",()=>l],8392)},928638,e=>{"use strict";let a=(0,e.i(383206).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);e.s(["Heart",()=>a],928638)},125677,563879,187215,e=>{"use strict";var a=e.i(662790),r=e.i(371526),l=e.i(324467),n=e.i(8392),i=e.i(928638),t=e.i(708519),s=e.i(106772),c=e.i(995403);e.i(856727);var d=e.i(469594),o=e.i(820713),m=e.i(290583),u=e.i(960824),p=e.i(443924),h=e.i(970770),x=e.i(44889),g=e.i(257428),b=e.i(101630);let G=({className:e,disabled:r,errorCodes:l=[],name:n,required:i,title:t,...s})=>{let{formState:{errors:c}}=(0,o.useFormContext)(),d=c[n],m=d?.type,u=m&&i&&("required"===m||l.includes(m));return(0,a.jsxs)("div",{className:(0,b.namespace)(b.Namespace.ClientSide,"CheckboxInput",e,"flex items-center gap-2"),children:[(0,a.jsx)(x.HiddenLabel,{htmlFor:n,children:n}),(0,a.jsx)(o.Controller,{name:n,disabled:r,rules:{required:i,...s},render:({field:{value:e,onChange:r}})=>(0,a.jsx)(g.Checkbox,{checked:e,onCheckedChange:r,id:n})}),t&&(0,a.jsx)(h.FieldLabel,{ariaHidden:!0,required:!!i,htmlFor:n,className:"cursor-pointer",children:t}),u&&(0,a.jsx)(p.FieldError,{}),d&&"custom"===m&&(0,a.jsx)(p.FieldError,{message:d.message})]})};var v=e.i(519455);let N=({defaultValue:e,onClick:n,onChange:i,className:t,min:c,max:d,...o})=>{let[m,u]=(0,s.useState)(e??0),p=e=>()=>{u(a=>{let r=Number(c),l=Number(d),i="decrement"===e?a-1:a+1;return null!=c&&i<r&&(i=r),null!=d&&i>l&&(i=l),n?.(i,e),i})};return(0,a.jsxs)("div",{className:(0,b.namespace)(b.Namespace.ClientSide,"Counter",t,"flex items-center justify-center gap-1 w-fit"),children:[(0,a.jsx)(v.Button,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:p("decrement"),children:(0,a.jsx)(l.Minus,{className:"h-3 w-3"})}),(0,a.jsx)("input",{type:"number",className:"max-w-10 text-center px-1 py-0.5",value:m,min:c,max:d,onChange:e=>{u(Number(e.target.value)),i?.(e)},...o}),(0,a.jsx)(v.Button,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:p("increment"),children:(0,a.jsx)(r.Plus,{className:"h-3 w-3"})})]})},f=({className:e,disabled:r,errorCodes:l=[],name:n,required:i,title:t,...s})=>{let{register:c,formState:{errors:d},getValues:m,setValue:u}=(0,o.useFormContext)(),g=d[n],G=g?.type,v=m(n),f=void 0!==v?Number(v):void 0,j=null!=s.min?"object"==typeof s.min?Number(s.min.value):Number(s.min):void 0,y=null!=s.max?"object"==typeof s.max?Number(s.max.value):Number(s.max):void 0,C=G&&i&&("required"===G||l.includes(G));return(0,a.jsxs)("div",{className:(0,b.namespace)(b.Namespace.ClientSide,"CounterInput",e),children:[t&&(0,a.jsx)(h.FieldLabel,{ariaHidden:!0,required:!!i,children:t}),(0,a.jsx)(x.HiddenLabel,{htmlFor:n,children:n}),(0,a.jsx)(N,{onClick:(e,a)=>{u(n,e,{shouldValidate:!0,shouldDirty:!0})},defaultValue:f,...c(n,{required:i,disabled:r,...s}),min:j,max:y}),C&&(0,a.jsx)(p.FieldError,{}),g&&"custom"===G&&(0,a.jsx)(p.FieldError,{message:g.message})]})};var j=e.i(14211),y=e.i(967489);let C=({children:e,className:r,disabled:l,errorCodes:n=[],name:i,required:t,title:s,...c})=>{let{control:d,formState:{errors:m}}=(0,o.useFormContext)(),u=m[i],g=u?.type,G=g&&t&&("required"===g||n.includes(g));return(0,a.jsxs)("div",{className:(0,b.namespace)(b.Namespace.ClientSide,"SelectInput",r),children:[s&&(0,a.jsx)(h.FieldLabel,{ariaHidden:!0,required:!!t,children:s}),(0,a.jsx)(x.HiddenLabel,{htmlFor:i,children:i}),(0,a.jsx)(o.Controller,{name:i,control:d,disabled:l,rules:{required:t,...c},render:({field:r})=>(0,a.jsx)(y.Select,{value:r.value,onValueChange:r.onChange,disabled:l,children:e})}),G&&(0,a.jsx)(p.FieldError,{}),u&&"custom"===g&&(0,a.jsx)(p.FieldError,{message:u.message})]})};var A=e.i(624687);let M=({className:e,disabled:r,errorCodes:l=[],name:n,required:i,title:t,...s})=>{let{register:c,formState:{errors:d}}=(0,o.useFormContext)(),m=d[n],u=m?.type,g=u&&i&&("required"===u||l.includes(u));return(0,a.jsxs)("div",{className:(0,b.namespace)(b.Namespace.ClientSide,"TextAreaInput",e),children:[t&&(0,a.jsx)(h.FieldLabel,{ariaHidden:!0,required:!!i,children:t}),(0,a.jsx)(x.HiddenLabel,{htmlFor:n,children:n}),(0,a.jsx)(A.Textarea,{...c(n,{required:i,disabled:r,...s})}),g&&(0,a.jsx)(p.FieldError,{}),m&&"custom"===u&&(0,a.jsx)(p.FieldError,{message:m.message})]})};var S=e.i(776639),w=e.i(110204),T=e.i(677572),E=e.i(960941),V=e.i(833277),P=e.i(817697),k=e.i(902363),I=e.i(523571);let O=(0,I.pgEnum)("collection_condition",["Mint","Near Mint","Lightly Played","Moderately Played","Heavily Played","Damaged","Sealed","Unspecified"]),F=(0,I.pgEnum)("collection_language",["English","Chinese"]),L=(0,I.pgEnum)("grading_company",["PSA","CGC","BGS","AP","Ace","GMA","HGA","PCA","SGC","TAG","Other"]),z=[{name:"PSA",grades:[{label:"PSA 10 GEM-MT",numericGrade:10},{label:"PSA 9 MINT",numericGrade:9},{label:"PSA 8.5 NM-MT+",numericGrade:8.5},{label:"PSA 8 NM-MT",numericGrade:8},{label:"PSA 7.5 NM+",numericGrade:7.5},{label:"PSA 7 NM",numericGrade:7},{label:"PSA 6.5 EX-MT+",numericGrade:6.5},{label:"PSA 6 EX-MT",numericGrade:6},{label:"PSA 5.5 EX+",numericGrade:5.5},{label:"PSA 5 EX",numericGrade:5},{label:"PSA 4.5 VG-EX+",numericGrade:4.5},{label:"PSA 4 VG-EX",numericGrade:4},{label:"PSA 3.5 VG+",numericGrade:3.5},{label:"PSA 3 VG",numericGrade:3},{label:"PSA 2.5 GOOD+",numericGrade:2.5},{label:"PSA 2 GOOD",numericGrade:2},{label:"PSA 1.5 FR",numericGrade:1.5},{label:"PSA 1 PR",numericGrade:1}]},{name:"CGC",grades:[{label:"CGC 10 Perfect",numericGrade:10},{label:"CGC 10 Gem Mint",numericGrade:10},{label:"CGC 10 Pristine",numericGrade:10},{label:"CGC 9.5 Mint+",numericGrade:9.5},{label:"CGC 9.5 Gem Mint",numericGrade:9.5},{label:"CGC 9 Mint",numericGrade:9},{label:"CGC 8.5 NM/Mint+",numericGrade:8.5},{label:"CGC 8 NM/Mint",numericGrade:8},{label:"CGC 7.5 NM+",numericGrade:7.5},{label:"CGC 7 NM",numericGrade:7},{label:"CGC 6.5 Ex/NM+",numericGrade:6.5},{label:"CGC 6 Ex/NM",numericGrade:6},{label:"CGC 5.5 Excellent+",numericGrade:5.5},{label:"CGC 5 Excellent",numericGrade:5},{label:"CGC 4.5 VG/Ex+",numericGrade:4.5},{label:"CGC 4 VG/Ex",numericGrade:4},{label:"CGC 3.5 Very Good+",numericGrade:3.5},{label:"CGC 3 Very Good",numericGrade:3},{label:"CGC 2.5 Good+",numericGrade:2.5},{label:"CGC 2 Good",numericGrade:2},{label:"CGC 1.5 Fair",numericGrade:1.5},{label:"CGC 1 Poor",numericGrade:1}]},{name:"BGS",grades:[{label:"BGS 10 PRISTINE",numericGrade:10},{label:"BGS 9.5 GEM MINT",numericGrade:9.5},{label:"BGS 9 MINT",numericGrade:9},{label:"BGS 8.5 NM-MT+",numericGrade:8.5},{label:"BGS 8 NM-MT",numericGrade:8},{label:"BGS 7.5 NEAR MINT+",numericGrade:7.5},{label:"BGS 7 NEAR MINT",numericGrade:7},{label:"BGS 6.5 EX-MT+",numericGrade:6.5},{label:"BGS 6 EX-MT",numericGrade:6},{label:"BGS 5.5 EXCELLENT+",numericGrade:5.5},{label:"BGS 5 EXCELLENT",numericGrade:5},{label:"BGS 4.5 VG-EX+",numericGrade:4.5},{label:"BGS 4 VG-EX",numericGrade:4},{label:"BGS 3.5 VERY GOOD+",numericGrade:3.5},{label:"BGS 3 VERY GOOD",numericGrade:3},{label:"BGS 2.5 G-VG",numericGrade:2.5},{label:"BGS 2 GOOD",numericGrade:2},{label:"BGS 1.5 FAIR",numericGrade:1.5},{label:"BGS 1 POOR",numericGrade:1}]},{name:"AP",grades:[{label:"AP 10 GEM MINT",numericGrade:10},{label:"AP 9.5 MINT+",numericGrade:9.5},{label:"AP 9.0 MINT",numericGrade:9},{label:"AP 8.5 NM-MINT",numericGrade:8.5},{label:"AP 8.0 NM-MINT",numericGrade:8},{label:"AP 7.5 NM",numericGrade:7.5},{label:"AP 7.0 NM",numericGrade:7},{label:"AP 6.5 EX-MINT",numericGrade:6.5},{label:"AP 6.0 EX-MINT",numericGrade:6},{label:"AP 5.5 EX",numericGrade:5.5},{label:"AP 5.0 EX",numericGrade:5},{label:"AP 4.5 VG-EX",numericGrade:4.5},{label:"AP 4.0 VG-EX",numericGrade:4},{label:"AP 3.5 VG",numericGrade:3.5},{label:"AP 3.0 VG",numericGrade:3},{label:"AP 2.5 GOOD",numericGrade:2.5},{label:"AP 2.0 GOOD",numericGrade:2},{label:"AP 1.5 POOR",numericGrade:1.5},{label:"AP 1.0 POOR",numericGrade:1}]},{name:"Ace",grades:[{label:"Ace GEM MINT",numericGrade:10},{label:"Ace MINT",numericGrade:9},{label:"Ace NM-MT",numericGrade:8},{label:"Ace NEAR MINT",numericGrade:7},{label:"Ace EX-MT",numericGrade:6},{label:"Ace EX",numericGrade:5},{label:"Ace VG",numericGrade:4},{label:"Ace GOOD",numericGrade:3},{label:"Ace FAIR",numericGrade:2},{label:"Ace POOR",numericGrade:1}]},{name:"GMA",grades:[{label:"GMA 10 GEM-MT",numericGrade:10},{label:"GMA 9 MINT",numericGrade:9},{label:"GMA 8.5 NM-MT+",numericGrade:8.5},{label:"GMA 8 NM-MT",numericGrade:8},{label:"GMA 7.5 NM+",numericGrade:7.5},{label:"GMA 7 NM",numericGrade:7},{label:"GMA 6.5 EX-NM+",numericGrade:6.5},{label:"GMA 6 EX-NM",numericGrade:6},{label:"GMA 5.5 EX+",numericGrade:5.5},{label:"GMA 5 EX",numericGrade:5},{label:"GMA 4.5 VG-EX+",numericGrade:4.5},{label:"GMA 4 VG-EX",numericGrade:4},{label:"GMA 3.5 VG+",numericGrade:3.5},{label:"GMA 3 VG",numericGrade:3},{label:"GMA 2.5 GOOD+",numericGrade:2.5},{label:"GMA 2 GOOD",numericGrade:2},{label:"GMA 1.5 FAIR+",numericGrade:1.5},{label:"GMA 1 FAIR",numericGrade:1}]},{name:"HGA",grades:[{label:"HGA 10 FLAWLESS",numericGrade:10},{label:"HGA 10 PRISTINE",numericGrade:10},{label:"HGA 9.5 GEM MT",numericGrade:9.5},{label:"HGA 9 MINT",numericGrade:9},{label:"HGA 8.5 NM-MT+",numericGrade:8.5},{label:"HGA 8 NM-MT",numericGrade:8},{label:"HGA 7.5 NM+",numericGrade:7.5},{label:"HGA 7 NM",numericGrade:7},{label:"HGA 6.5 EX-NM+",numericGrade:6.5},{label:"HGA 6 EX-NM",numericGrade:6},{label:"HGA 5.5 EX+",numericGrade:5.5},{label:"HGA 5 EX",numericGrade:5},{label:"HGA 4.5 VG-EX+",numericGrade:4.5},{label:"HGA 4 VG-EX",numericGrade:4},{label:"HGA 3.5 VG+",numericGrade:3.5},{label:"HGA 3 VG",numericGrade:3},{label:"HGA 2.5 GOOD+",numericGrade:2.5},{label:"HGA 2 GOOD",numericGrade:2},{label:"HGA 1.5 FAIR",numericGrade:1.5},{label:"HGA 1 POOR",numericGrade:1}]},{name:"PCA",grades:[{label:"PCA 10+ Collector",numericGrade:10.5},{label:"PCA 10 Gem mint",numericGrade:10},{label:"PCA 9.5 Mint",numericGrade:9.5},{label:"PCA 9 Near mint",numericGrade:9},{label:"PCA 8 Excellent - Near mint",numericGrade:8},{label:"PCA 7 Excellent",numericGrade:7},{label:"PCA 6 Very good",numericGrade:6},{label:"PCA 5 Good",numericGrade:5},{label:"PCA 4 Light played",numericGrade:4},{label:"PCA 3 Played",numericGrade:3},{label:"PCA 2 Poor",numericGrade:2},{label:"PCA 1 Very poor",numericGrade:1}]},{name:"SGC",grades:[{label:"SGC 10 PRI",numericGrade:10},{label:"SGC 10 GM",numericGrade:10},{label:"SGC 9.5 MINT+",numericGrade:9.5},{label:"SGC 9 MINT",numericGrade:9},{label:"SGC 8.5 NM/MT+",numericGrade:8.5},{label:"SGC 8 NM/MT",numericGrade:8},{label:"SGC 7.5 NM+",numericGrade:7.5},{label:"SGC 7 NRMT",numericGrade:7},{label:"SGC 6.5 EX/NM+",numericGrade:6.5},{label:"SGC 6 EX/NM",numericGrade:6},{label:"SGC 5.5 EX+",numericGrade:5.5},{label:"SGC 5 EX",numericGrade:5},{label:"SGC 4.5 VG/EX+",numericGrade:4.5},{label:"SGC 4 VG/EX",numericGrade:4},{label:"SGC 3.5 VG+",numericGrade:3.5},{label:"SGC 3 VG",numericGrade:3},{label:"SGC 2.5 GOOD+",numericGrade:2.5},{label:"SGC 2 GOOD",numericGrade:2},{label:"SGC 1.5 FAIR",numericGrade:1.5},{label:"SGC 1 POOR",numericGrade:1}]},{name:"TAG",grades:[{label:"TAG PRISTINE",numericGrade:10},{label:"TAG GEM MINT",numericGrade:9.5},{label:"TAG MINT",numericGrade:9},{label:"TAG NM MT+",numericGrade:8.5},{label:"TAG NM MT",numericGrade:8},{label:"TAG NM+",numericGrade:7.5},{label:"TAG NM",numericGrade:7},{label:"TAG EX MT+",numericGrade:6.5},{label:"TAG EX MT",numericGrade:6},{label:"TAG EX+",numericGrade:5.5},{label:"TAG EX",numericGrade:5},{label:"TAG VG EX+",numericGrade:4.5},{label:"TAG VG EX",numericGrade:4},{label:"TAG VG+",numericGrade:3.5},{label:"TAG VG",numericGrade:3},{label:"TAG GOOD+",numericGrade:2.5},{label:"TAG GOOD",numericGrade:2},{label:"TAG FAIR",numericGrade:1.5},{label:"TAG POOR",numericGrade:1}]},{name:"Other",grades:[{label:"Graded 10.5",numericGrade:10.5},{label:"Graded 10",numericGrade:10},{label:"Graded 9.5",numericGrade:9.5},{label:"Graded 9",numericGrade:9},{label:"Graded 8.5",numericGrade:8.5},{label:"Graded 8",numericGrade:8},{label:"Graded 7.5",numericGrade:7.5},{label:"Graded 7",numericGrade:7},{label:"Graded 6.5",numericGrade:6.5},{label:"Graded 6",numericGrade:6},{label:"Graded 5.5",numericGrade:5.5},{label:"Graded 5",numericGrade:5},{label:"Graded 4.5",numericGrade:4.5},{label:"Graded 4",numericGrade:4},{label:"Graded 3.5",numericGrade:3.5},{label:"Graded 3",numericGrade:3},{label:"Graded 2.5",numericGrade:2.5},{label:"Graded 2",numericGrade:2},{label:"Graded 1.5",numericGrade:1.5},{label:"Graded 1",numericGrade:1}]}],D=e=>{let a=z.find(a=>a.name===e);return a?.grades||[]},q=m.z.object({quantity:m.z.number().int().min(1),language:m.z.enum(F.enumValues),variantId:m.z.string().uuid(),conditionType:m.z.enum(["condition","grading"]),condition:m.z.enum(O.enumValues).optional(),gradingCompany:m.z.enum(L.enumValues).optional(),gradeValue:m.z.string().optional(),notes:m.z.string().optional(),addAnother:m.z.boolean().optional()}).refine(e=>"condition"===e.conditionType?void 0!==e.condition:void 0!==e.gradingCompany&&void 0!==e.gradeValue,{message:"Please provide either condition or grading information"}),R=({defaultQuantity:e=1,defaultVariantId:r,cardName:l,children:n,setOpen:i,open:t,variants:o})=>{let m=(0,V.useUserContext)(),u=(0,P.useTRPC)(),p=(0,E.getQueryClientInstance)(),[h,x]=(0,s.useState)(0);(0,s.useEffect)(()=>{t&&x(e=>e+1)},[t,r]);let[g,b]=(0,s.useState)(!1),{mutate:G,isPending:v}=(0,k.useTRPCMutation)(({collection:e})=>e.addCard.mutationOptions({onSuccess:(e,a)=>{if(c.toast.success(`Added ${a.quantity} ${l} to collection`),m?.id){let e=u.collection?.cards?.queryKey?.({userId:m.id}),a=u.collection?.getByUser?.queryKey?.({userId:m.id});e&&p.invalidateQueries({queryKey:e}),a&&p.invalidateQueries({queryKey:a})}g?x(e=>e+1):i(!1)},onError:e=>{console.error("Failed to add to collection:",e),c.toast.error(`Failed to add to collection: ${e.message}`)}})),N={quantity:e,language:"English",variantId:r||(o[0]?.id??""),conditionType:"condition",condition:"Near Mint",gradingCompany:"PSA",gradeValue:"10",notes:"",addAnother:!1};return(0,a.jsxs)(S.Dialog,{open:t,onOpenChange:i,children:[n&&(0,a.jsx)(S.DialogTrigger,{asChild:!0,children:n}),(0,a.jsxs)(S.DialogContent,{children:[(0,a.jsx)(S.DialogHeader,{children:(0,a.jsxs)(S.DialogTitle,{children:["Add ",(0,a.jsx)("span",{className:"italic",children:l})," To Collection"]})}),(0,a.jsx)(j.Form,{className:"flex flex-col gap-4",onSubmit:e=>{if(!m?.id)return void c.toast.error("You must be logged in to add cards to your collection");b(e.addAnother||!1);let a={userId:m.id,variantId:e.variantId,quantity:e.quantity,language:e.language,notes:e.notes};if("condition"===e.conditionType&&e.condition)a.condition=e.condition;else if("grading"===e.conditionType&&e.gradingCompany&&void 0!==e.gradeValue){let r=Number.parseFloat(e.gradeValue),l=z.find(a=>a.name===e.gradingCompany),n=l?.grades.find(e=>e.numericGrade===r);a.grading={company:e.gradingCompany,grade:r,label:n?.label||`Graded ${r}`}}G(a)},config:{defaultValues:N,mode:"all",resolver:(0,d.zodResolver)(q)},children:(0,a.jsx)(B,{variants:o,isPending:v})},h)]})]})};function B({variants:e,isPending:r}){let{setValue:l}=(0,o.useFormContext)(),n=(0,o.useWatch)({name:"conditionType"})||"condition",i=(0,o.useWatch)({name:"gradingCompany"})||"PSA",[t,c]=(0,s.useState)(D(i));return(0,s.useEffect)(()=>{"grading"===n&&(c(D(i)),l("gradeValue",void 0))},[i,n,l]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{name:"quantity",title:"Quantity",min:1,errorCodes:[u.ZodIssueCode.too_small],required:!0}),(0,a.jsxs)(C,{name:"variantId",title:"Variant",required:!0,children:[(0,a.jsx)(y.SelectTrigger,{className:"w-full cursor-pointer",children:(0,a.jsx)(y.SelectValue,{placeholder:"Select a variant"})}),(0,a.jsx)(y.SelectContent,{children:e.map(e=>(0,a.jsx)(y.SelectItem,{className:"cursor-pointer",value:e.id,children:e.variantLabel||"Normal"},e.id))})]}),(0,a.jsxs)(C,{name:"language",title:"Language",required:!0,children:[(0,a.jsx)(y.SelectTrigger,{className:"w-full cursor-pointer",children:(0,a.jsx)(y.SelectValue,{placeholder:"Select a language"})}),(0,a.jsx)(y.SelectContent,{children:F.enumValues.map(e=>(0,a.jsx)(y.SelectItem,{className:"cursor-pointer",value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(w.Label,{children:"Card State"}),(0,a.jsxs)(T.Tabs,{value:n,onValueChange:e=>l("conditionType",e),className:"w-full",children:[(0,a.jsxs)(T.TabsList,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(T.TabsTrigger,{value:"condition",children:"Ungraded"}),(0,a.jsx)(T.TabsTrigger,{value:"grading",children:"Graded"})]}),(0,a.jsx)(T.TabsContent,{value:"condition",className:"mt-3",children:(0,a.jsxs)(C,{name:"condition",title:"Condition",children:[(0,a.jsx)(y.SelectTrigger,{className:"w-full cursor-pointer",children:(0,a.jsx)(y.SelectValue,{placeholder:"Select a condition"})}),(0,a.jsx)(y.SelectContent,{children:O.enumValues.map(e=>(0,a.jsx)(y.SelectItem,{className:"cursor-pointer",value:e,children:e},e))})]})}),(0,a.jsx)(T.TabsContent,{value:"grading",className:"mt-3 space-y-3",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsxs)(C,{name:"gradingCompany",title:"Company",children:[(0,a.jsx)(y.SelectTrigger,{className:"w-full cursor-pointer",children:(0,a.jsx)(y.SelectValue,{placeholder:"Company"})}),(0,a.jsx)(y.SelectContent,{children:L.enumValues.map(e=>(0,a.jsx)(y.SelectItem,{className:"cursor-pointer",value:e,children:e},e))})]})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsxs)(C,{name:"gradeValue",title:"Grade",children:[(0,a.jsx)(y.SelectTrigger,{className:"w-full cursor-pointer",children:(0,a.jsx)(y.SelectValue,{placeholder:"Grade"})}),(0,a.jsx)(y.SelectContent,{children:t.map(e=>(0,a.jsx)(y.SelectItem,{className:"cursor-pointer",value:e.numericGrade.toString(),children:e.label},`${e.numericGrade}-${e.label}`))})]})})]})})]})]}),(0,a.jsx)(M,{name:"notes",title:"Notes"}),(0,a.jsx)(G,{name:"addAnother",title:"Add another one"}),(0,a.jsx)(v.Button,{type:"submit",className:"w-full",disabled:r,children:r?"Adding...":"Add To Collection"})]})}var H=e.i(383206);let X=(0,H.default)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),$=(0,H.default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),U=(0,H.default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),K=(0,H.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),Q=({cardName:e,parentVariant:r,childVariants:n,open:i,onOpenChange:t,trigger:c})=>{let[d,o]=(0,s.useState)(!1),m=e=>e&&"0"!==e&&"0.00"!==e?`${Number.parseFloat(e).toFixed(2)} €`:"N/A",u=[r,...[...n].sort((e,a)=>{let r=e.variantLabel,l=a.variantLabel;return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)})];return(0,a.jsxs)(S.Dialog,{open:void 0!==i?i:d,onOpenChange:e=>{t?t(e):o(e)},children:[c&&(0,a.jsx)(S.DialogTrigger,{asChild:!0,children:c}),(0,a.jsxs)(S.DialogContent,{className:"max-w-md",children:[(0,a.jsx)(S.DialogHeader,{children:(0,a.jsxs)(S.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)($,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"italic",children:e})]})}),(0,a.jsx)("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:u.map((e,r)=>{let n;return n=e.prices&&(e.prices.avg||e.prices.low),(0,a.jsxs)("div",{className:`grid grid-cols-1 gap-3 p-4 rounded-md ${0===r?"bg-zinc-800/50":"bg-zinc-900/30"}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-white",children:e.variantLabel}),(0,a.jsx)("span",{className:"text-xs text-zinc-400 uppercase",children:e.rarity})]}),n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"Low"}),(0,a.jsx)("span",{className:"font-bold text-green-500",children:m(e.prices?.low)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"Average"}),(0,a.jsx)("span",{className:"font-bold text-blue-400",children:m(e.prices?.avg)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"Trend"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{if(!e)return null;let r=Number.parseFloat(e);return r>0?(0,a.jsx)(U,{className:"h-4 w-4 text-green-500"}):r<0?(0,a.jsx)(K,{className:"h-4 w-4 text-red-500"}):(0,a.jsx)(l.Minus,{className:"h-4 w-4 text-zinc-400"})})(e.prices?.trend),(0,a.jsx)("span",{className:`font-bold ${(e=>{if(!e)return"text-zinc-400";let a=Number.parseFloat(e);return a>0?"text-green-500":a<0?"text-red-500":"text-zinc-400"})(e.prices?.trend)}`,children:m(e.prices?.trend)})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-zinc-700 pt-2",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400 font-semibold mb-2 block",children:"Historical Averages"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"1 Day"}),(0,a.jsx)("span",{className:"font-bold text-zinc-300",children:m(e.prices?.avg1)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"7 Days"}),(0,a.jsx)("span",{className:"font-bold text-zinc-300",children:m(e.prices?.avg7)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-400",children:"30 Days"}),(0,a.jsx)("span",{className:"font-bold text-zinc-300",children:m(e.prices?.avg30)})]})]})]}),e.cardmarketId&&(0,a.jsxs)("a",{href:`https://www.cardmarket.com/en/Riftbound/Products?idProduct=${e.cardmarketId}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 hover:underline flex items-center gap-1",children:[(0,a.jsx)("span",{children:"View on Cardmarket"}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),(0,a.jsx)("polyline",{points:"15 3 21 3 21 9"}),(0,a.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}):(0,a.jsx)("div",{className:"text-sm text-zinc-500 italic",children:"No price data available"})]},r)})})]})]})},_=()=>(0,a.jsx)("div",{className:"col-span-full h-0.5 bg-input"});var W=e.i(210933);let Y=({className:e,text:r})=>(0,a.jsx)("div",{className:(0,W.classes)("py-1 px-2 bg-input text-white font-bold w-fit rounded-lg",e),children:r}),Z={english:"EN",chinese:"CN"},J=({language:e,treatment:r,notes:l,count:n,condition:i,gradingCompany:t,gradeLabel:s,onChange:c,min:d=0,max:o})=>{let m=t&&s;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_,{}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-lg",children:r}),(0,a.jsxs)("span",{className:"flex flex-row gap-2",children:[(0,a.jsx)(Y,{text:Z[e]}),m?(0,a.jsx)(Y,{text:s}):i&&(0,a.jsx)(Y,{text:i})]}),(0,a.jsx)("span",{className:"italic",children:l})]}),(0,a.jsx)(N,{className:"ml-auto font-bold",defaultValue:n,onClick:c,onChange:({target:{value:e}})=>{c(Number(e))},min:d,max:o})]})},ee=({cardName:e,collectionEntries:l,variants:n,userId:i,children:t,open:d,setOpen:o,parentVariant:m,childVariants:u=[]})=>{let p=(0,P.useTRPC)(),h=(0,E.getQueryClientInstance)(),[x,g]=(0,s.useState)(new Map),[b,G]=(0,s.useState)(!1),[N,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d&&g(new Map)},[d]);let{mutate:j}=(0,k.useTRPCMutation)(({collection:e})=>e.updateCard.mutationOptions({onSuccess:()=>{let e=p.collection?.cards?.queryKey?.({userId:i}),a=p.collection?.getByUser?.queryKey?.({userId:i});e&&h.invalidateQueries({queryKey:e}),a&&h.invalidateQueries({queryKey:a})},onError:e=>{c.toast.error(`Failed to update collection: ${e.message}`)}})),y=(e,a)=>x.has(e)?x.get(e):a,C=()=>{0===x.size||(x.forEach((e,a)=>{j({userId:i,id:a,quantity:e})}),c.toast.success("Collection updated"),g(new Map)),o(!1)},A=l.reduce((e,a)=>e+y(a.id,a.quantity),0);return(0,a.jsxs)(S.Dialog,{open:d,onOpenChange:e=>{e?o(e):C()},children:[t&&(0,a.jsx)(S.DialogTrigger,{asChild:!0,children:t}),(0,a.jsxs)(S.DialogContent,{children:[(0,a.jsx)(S.DialogHeader,{children:(0,a.jsx)(S.DialogTitle,{children:(0,a.jsx)("span",{className:"italic",children:e})})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(v.Button,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>G(!0),children:[(0,a.jsx)(r.Plus,{className:"h-4 w-4 mr-2"}),"Add to Collection"]}),m&&(0,a.jsxs)(v.Button,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>f(!0),children:[(0,a.jsx)($,{className:"h-4 w-4 mr-2"}),"View Prices"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 font-bold",children:[(0,a.jsx)(X,{strokeWidth:4,className:"h-4 w-4"})," Total Cards"]}),(0,a.jsx)("span",{className:"font-bold ml-auto mr-11",children:A}),l.map(e=>{var r;let l,i;return(0,a.jsx)(J,{count:y(e.id,e.quantity),language:e.language.toLowerCase(),treatment:(r=e.variantId,l=n.find(e=>e.id===r),l?.variantLabel||"Unknown"),notes:e.notes||void 0,condition:e.condition,gradingCompany:e.gradingCompany,gradeLabel:e.gradeLabel,onChange:(i=e.id,e=>{let a=Math.max(0,e);g(e=>{let r=new Map(e);return r.set(i,a),r})}),min:0},e.id)})]}),(0,a.jsx)(v.Button,{onClick:C,children:"Save & Close"})]}),(0,a.jsx)(R,{cardName:e,variants:n,open:b,setOpen:G}),m&&(0,a.jsx)(Q,{cardName:e,parentVariant:m,childVariants:u,open:N,onOpenChange:f})]})};var ea=e.i(948247);let er=({children:e,...r})=>(0,a.jsx)(ea.Root,{...r,children:e}),el=({children:e,className:r,...l})=>{let n=(0,W.classes)(r,"bg-card border border-border rounded-md p-2");return(0,a.jsx)(ea.Portal,{children:(0,a.jsxs)(ea.Content,{className:n,...l,children:[e,(0,a.jsx)(ea.Arrow,{className:"fill-card"})]})})},en=({children:e,className:r,...l})=>{let n=(0,W.classes)(r,"cursor-pointer flex items-center gap-8 justify-between hover:bg-input");return(0,a.jsx)(ea.Item,{className:n,...l,children:e})},ei=({children:e,...r})=>(0,a.jsx)(ea.Trigger,{...r,children:e}),et="piltover_collection_add_mode",es="piltover_collection_add_mode_change";function ec(){let[e,a]=(0,s.useState)("full"),[r,l]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=localStorage.getItem(et);e&&("quick"===e||"variant"===e||"full"===e)&&a(e),l(!0);let r=e=>{a(e.detail)};return window.addEventListener(es,r),()=>{window.removeEventListener(es,r)}},[]),{mode:e,setMode:e=>{a(e),localStorage.setItem(et,e);let r=new CustomEvent(es,{detail:e});window.dispatchEvent(r)},isLoaded:r}}e.s(["COLLECTION_ADD_MODES",0,{quick:{label:"Quick Add",description:"Add cards instantly with default settings (no variant selection, no dialog)"},variant:{label:"Variant Selection",description:"Choose variant, then add with default settings (no dialog)"},full:{label:"Full Control",description:"Choose variant and customize all details (current behavior)"}},"useCollectionAddMode",()=>ec],563879);let ed=()=>(0,a.jsx)("div",{className:"relative aspect-[63/88] w-full overflow-hidden rounded-[3.8%]",children:(0,a.jsx)(t.default,{src:"https://cdn.piltoverarchive.com/Cardback.webp",alt:"Loading...",fill:!0,className:"animate-pulse object-cover brightness-[0.15] grayscale transition-all duration-1000"})});e.s(["default",0,ed],187215);var eo=e.i(51866),em=e.i(87912),eu=e.i(487486);let ep={tap:"https://cdn.piltoverarchive.com/icons/tap.webp",rune:"https://cdn.piltoverarchive.com/icons/rune.webp",might:"https://cdn.piltoverarchive.com/icons/might.webp",body:"https://cdn.piltoverarchive.com/icons/body.webp",calm:"https://cdn.piltoverarchive.com/icons/calm.webp",chaos:"https://cdn.piltoverarchive.com/icons/chaos.webp",fury:"https://cdn.piltoverarchive.com/icons/fury.webp",mind:"https://cdn.piltoverarchive.com/icons/mind.webp",order:"https://cdn.piltoverarchive.com/icons/order.webp",0:"https://cdn.piltoverarchive.com/icons/0.svg",1:"https://cdn.piltoverarchive.com/icons/1.svg",2:"https://cdn.piltoverarchive.com/icons/2.svg",3:"https://cdn.piltoverarchive.com/icons/3.svg",4:"https://cdn.piltoverarchive.com/icons/4.svg",5:"https://cdn.piltoverarchive.com/icons/5.svg",6:"https://cdn.piltoverarchive.com/icons/6.svg",7:"https://cdn.piltoverarchive.com/icons/7.svg",8:"https://cdn.piltoverarchive.com/icons/8.svg",9:"https://cdn.piltoverarchive.com/icons/9.svg",10:"https://cdn.piltoverarchive.com/icons/10.svg",11:"https://cdn.piltoverarchive.com/icons/11.svg"},eh={Mighty:{text:"MIGHTY",background:"#686868",color:"#ffffff"},Add:{text:"ADD",background:"#686868",color:"#ffffff"},Accelerate:{text:"ACCELERATE",background:"#246f60",color:"#ffffff"},Action:{text:"ACTION",background:"#246f60",color:"#ffffff"},Assault:{text:"ASSAULT",background:"#d0346d",color:"#ffffff"},Deathknell:{text:"DEATHKNELL",background:"#93ad2f",color:"#000000"},Deflect:{text:"DEFLECT",background:"#93ad2f",color:"#000000"},Ganking:{text:"GANKING",background:"#93ad2f",color:"#000000"},Hidden:{text:"HIDDEN",background:"#246f60",color:"#ffffff"},Legion:{text:"LEGION",background:"#246f60",color:"#ffffff"},Reaction:{text:"REACTION",background:"#14a381",color:"#ffffff"},Shield:{text:"SHIELD",background:"#d0346d",color:"#ffffff"},Tank:{text:"TANK",background:"#d0346d",color:"#ffffff"},Temporary:{text:"TEMPORARY",background:"#93ad2f",color:"#000000"},Vision:{text:"VISION",background:"#6d6e70",color:"#ffffff"}};function ex({card:e,isOpen:r,onOpenChange:l,orientation:n="portrait",chosenVariant:i}){var c;let d=(0,s.useMemo)(()=>{if(!e.cardVariants)return[];let a=["Standard","Alt Art","Overnumbered","Overnumbered Signed"];return[...e.cardVariants].sort((e,r)=>a.indexOf(e.variantType)-a.indexOf(r.variantType))},[e.cardVariants]),[o,m]=(0,s.useState)(()=>{if(i){let e=d.findIndex(e=>e.id===i);return e>=0?e:0}let e=d.findIndex(e=>"Standard"===e.variantType);return e>=0?e:0}),[u,p]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1),g=d[o],b="landscape"===n||"Battlefield"===e.type;return(0,a.jsx)(S.Dialog,{open:r,onOpenChange:l,children:(0,a.jsxs)(S.DialogContent,{className:"max-h-[90vh] w-full md:min-w-[50vw] md:w-[50vw] md:max-w-[95vw] overflow-y-auto p-4 pb-8 md:p-6 md:pb-12",children:[(0,a.jsx)(S.DialogHeader,{className:"relative bg-background pb-4",children:(0,a.jsx)(S.DialogTitle,{className:"text-xl md:text-2xl pr-8",children:e.name})}),(0,a.jsxs)("div",{className:"grid gap-4 md:gap-8 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"relative w-full overflow-hidden rounded-[3.8%]",style:{aspectRatio:b?"88/63":"63/88"},children:[u&&(0,a.jsx)(ed,{}),(g?.imageUrl||h)&&(0,a.jsx)(t.default,{src:h?"https://cdn.piltoverarchive.com/placeholder.webp":(c=g?.imageUrl,b?c.replace("/cards/","/cards/landscape/"):c),alt:e.name,fill:!0,className:"object-contain transition-opacity duration-300",priority:!0,draggable:"false",onLoadingComplete:()=>p(!1),onError:()=>{x(!0),p(!1)},style:{opacity:+!u}})]}),d.length>1&&(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,a.jsx)(v.Button,{variant:"outline",size:"icon",onClick:()=>{0!==d.length&&m(e=>(e-1+d.length)%d.length)},className:"h-8 w-8",children:(0,a.jsx)(eo.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:g?.variantType}),(0,a.jsx)(v.Button,{variant:"outline",size:"icon",onClick:()=>{0!==d.length&&m(e=>(e+1)%d.length)},className:"h-8 w-8",children:(0,a.jsx)(em.ChevronRight,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col overflow-y-auto pr-2 md:pr-4",children:[(0,a.jsxs)("div",{className:"space-y-6 md:space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[(0,a.jsxs)(eu.Badge,{variant:"outline",className:"flex min-w-0 items-center gap-1.5 px-2 py-1",children:[(0,a.jsx)(t.default,{src:`https://cdn.piltoverarchive.com/types/${e.type.toLowerCase().replace("token","unit").replace("card","might")}.webp`,alt:e.type,width:24,height:24,className:"shrink-0",draggable:"false"}),(0,a.jsx)("span",{className:"truncate text-base font-medium",children:e.super?`${e.super} ${e.type}`:e.type})]}),g?.rarity&&(0,a.jsxs)(eu.Badge,{variant:"outline",className:"flex min-w-0 items-center gap-1.5 px-2 py-1",children:[(0,a.jsx)(t.default,{src:`https://cdn.piltoverarchive.com/rarities/${g.rarity.toLowerCase()}.webp`,alt:g.rarity,width:24,height:24,className:"shrink-0",draggable:"false"}),(0,a.jsx)("span",{className:"truncate text-base font-medium",children:g.rarity})]}),e.cardColors&&e.cardColors.length>0&&(0,a.jsx)("div",{className:"flex gap-2",children:e.cardColors.map(({color:e})=>(0,a.jsxs)(eu.Badge,{variant:"outline",className:"flex min-w-0 items-center gap-1.5 px-2 py-1",children:[(0,a.jsx)(t.default,{src:e.imageUrl,alt:e.name,width:24,height:24,className:"shrink-0",draggable:"false"}),(0,a.jsx)("span",{className:"truncate text-base font-medium",children:e.name})]},e.name))})]}),e.tags&&e.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.map(e=>(0,a.jsx)(eu.Badge,{variant:"secondary",className:"text-sm",children:e},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6 rounded-lg bg-zinc-800/50 p-4",children:[null!==e.energy&&(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:"Energy"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.energy})]}),null!==e.power&&(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:"Power"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.power})]}),null!==e.might&&(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:"Might"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.might})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Description"}),(0,a.jsx)("p",{className:"text-base text-zinc-300 whitespace-pre-wrap leading-relaxed",children:(e=>{let r,l=[],n=0,i=/\(([^)]+)\)/g;for(;null!==(r=i.exec(e));)r.index>n&&l.push({text:e.slice(n,r.index),isParenthetical:!1}),r[1]&&l.push({text:r[1],isParenthetical:!0}),n=r.index+r[0].length;n<e.length&&l.push({text:e.slice(n),isParenthetical:!1});let s=[];return l.forEach(e=>{let r=[e.text];Object.entries(ep).forEach(([e,l])=>{let n=RegExp(`\\[${e}\\]`,"gi");r=r.flatMap(r=>{if("string"==typeof r){let i=r.split(n),s=r.match(n)||[];return i.reduce((r,n,i)=>(n&&r.push(n),s[i]&&r.push((0,a.jsx)(t.default,{src:l,alt:e,width:24,height:24,className:"inline-block align-middle mx-0.5 my-[-4px]"},`${e}-${i}`)),r),[])}return r})}),Object.entries(eh).forEach(([e,{text:l,background:n,color:i}])=>{let t=RegExp(`\\[${e}(?:\\s+(\\d+))?\\]`,"gi");r=r.flatMap(r=>{if("string"==typeof r){let s=r.split(t),c=r.match(t)||[];return s.reduce((r,t,s)=>{if(t&&!/^\d+$/.test(t)&&r.push(t),c[s]){let t=c[s].match(/\d+/),d=t?t[0]:"";r.push((0,a.jsxs)("span",{className:"inline-block px-2 py-0.5 mx-0.5 my-[-2px] transform -skew-x-12",style:{backgroundColor:n,color:i,fontWeight:"bold",borderRadius:"0px"},children:[l,d?` ${d}`:""]},`${e}-${s}`))}return r},[])}return r})}),e.isParenthetical?s.push((0,a.jsxs)("span",{className:"italic",children:["(",r,")"]},`parenthetical-${s.length}`)):s.push(...r)}),s})(e.description).map((e,r)=>(0,a.jsx)(s.default.Fragment,{children:e},r))})]})]}),(0,a.jsxs)("div",{className:"mt-auto space-y-8 pt-8",children:[g?.flavorText&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Flavor Text"}),(0,a.jsx)("p",{className:"text-base italic text-zinc-400",children:g.flavorText})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-zinc-800/50 p-4",children:[(0,a.jsx)("h3",{className:"mb-3 text-lg font-medium",children:"Card Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-zinc-400",children:[g?.artist&&(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Artist:"}),g.artist]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Set:"}),g?.set.name]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Card Number:"}),g?.variantNumber]})]})]})]})]})]})]})})}function eg({card:e,viewMode:d="compact",onCardClick:o,dialogTrigger:m="left",disableHover:u=!1,disableDialog:p=!1,chosenVariant:h,orientation:x="portrait",isSideboardMode:g=!1,showCollectionCounter:b=!1,fadeUnowned:G=!1,deck:N,collectionData:f}){var j;let y,[C,A]=(0,s.useState)(!1),[M,S]=(0,s.useState)(!1),[w,T]=(0,s.useState)(),[I,O]=(0,s.useState)(!0),[F,L]=(0,s.useState)(!1),[z,D]=(0,s.useState)(!1),[q,B]=(0,s.useState)(!1),[H,X]=(0,s.useState)(!1),[$,U]=(0,s.useState)(!1),K=(0,V.useUserContext)(),_=(0,P.useTRPC)(),W=(0,E.getQueryClientInstance)(),{mode:Y}=ec(),{mutate:Z}=(0,k.useTRPCMutation)(({collection:e})=>e.updateCard.mutationOptions({onSuccess:()=>{if(c.toast.success("Collection updated"),K?.id){let e=_.collection?.cards?.queryKey?.({userId:K.id}),a=_.collection?.getByUser?.queryKey?.({userId:K.id});e&&W.invalidateQueries({queryKey:e}),a&&W.invalidateQueries({queryKey:a})}},onError:e=>{c.toast.error(`Failed to update collection: ${e.message}`)}})),{mutate:J}=(0,k.useTRPCMutation)(({wishlist:e})=>e.toggle.mutationOptions({onSuccess:e=>{if(c.toast.success(e.added?"Added to wishlist":"Removed from wishlist"),K?.id){let e=_.collection?.cards?.queryKey?.({userId:K.id}),a=_.wishlist?.getByUser?.queryKey?.({userId:K.id});e&&W.invalidateQueries({queryKey:e}),a&&W.invalidateQueries({queryKey:a})}},onError:e=>{c.toast.error(`Failed to update wishlist: ${e.message}`)}})),{mutate:ea}=(0,k.useTRPCMutation)(({collection:a})=>a.addCard.mutationOptions({onSuccess:(a,r)=>{if(c.toast.success(`Added 1 ${e.name} to collection`),K?.id){let e=_.collection?.cards?.queryKey?.({userId:K.id}),a=_.collection?.getByUser?.queryKey?.({userId:K.id});e&&W.invalidateQueries({queryKey:e}),a&&W.invalidateQueries({queryKey:a})}},onError:e=>{c.toast.error(`Failed to add to collection: ${e.message}`)}})),et=e=>{K?.id?ea({userId:K.id,variantId:e,quantity:1,language:"English",condition:"Near Mint"}):c.toast.error("You must be logged in to add cards to your collection")},es=h?e.cardVariants?.find(e=>e.id===h):(y=e.cardVariants?.find(e=>"Showcase"===e.rarity&&["Alt Art","Overnumbered","Overnumbered Signed"].includes(e.variantType)))||e.cardVariants?.find(e=>"Standard"===e.variantType),eo=N&&es?g?(N.sideboard?.filter(a=>a.card.id===e.id&&a.variantId===es.id)||[]).reduce((e,a)=>e+a.count,0):[...N.legend?[N.legend]:[],...N.battlefields,...N.champions,...N.mainDeck,...N.runes].filter(a=>a.card.id===e.id&&a.variantId===es.id).reduce((e,a)=>e+a.count,0):0,em="landscape"===x||void 0===x&&"Battlefield"===e.type,eu=b?(f?.parentVariant.userData?.quantity||0)+(f?.children?.reduce((e,a)=>e+(a.variant.userData?.quantity||0),0)||0):0,ep=b&&0===eu;return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:`group relative w-full cursor-pointer overflow-hidden rounded-[3.8%] transition-transform
          ${!u&&"hover:scale-105"}
          ${!q&&"active:scale-100"}`,style:{aspectRatio:em?"88/63":"63/88"},onClick:a=>{p||"left"!==m?o&&es&&o(e,es.id,"add"):L(!0)},onContextMenu:e=>{p||"right"!==m||(e.preventDefault(),L(!0))},children:[I&&(0,a.jsx)(ed,{}),(es?.imageUrl||z)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.default,{src:z?"https://cdn.piltoverarchive.com/placeholder.webp":(j=es?.imageUrl,em?j.replace("/cards/","/cards/landscape/"):j),alt:e.name,fill:!0,loading:"lazy",className:`object-cover transition-opacity duration-300 ${ep?"grayscale group-hover:grayscale-0":""}`,onLoadingComplete:()=>O(!1),onError:()=>{D(!0),O(!1)},style:{opacity:+!I},draggable:"false"}),ep&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/0 transition-colors pointer-events-none"}),b&&(0,a.jsx)("button",{type:"button",className:"absolute bottom-2 right-2 z-10 px-2 py-1 bg-zinc-800/80 backdrop-blur-sm rounded-md hover:bg-zinc-700/80 transition-colors cursor-pointer",onClick:e=>{e.stopPropagation(),U(!0)},children:(0,a.jsx)("span",{className:"text-md font-semibold text-green-500",children:f?.prices?.low!=null?`${Number.parseFloat(f.prices.low).toFixed(2)} €`:"N/A"})})]}),eo>0&&!o&&(0,a.jsx)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",children:(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-zinc-800 text-white text-md font-bold rounded-full shadow-lg border-2 border-white",children:eo})}),o&&es&&eo>0&&(0,a.jsx)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",onMouseDown:e=>{e.stopPropagation(),B(!0)},onMouseUp:e=>{e.stopPropagation(),B(!1)},onMouseLeave:e=>{e.stopPropagation(),B(!1)},children:(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-zinc-800/90 rounded-full p-1 shadow-lg border border-white/20",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:a=>{a.stopPropagation(),eo>0&&o(e,es.id,"remove")},children:(0,a.jsx)(l.Minus,{className:"h-3 w-3"})}),(0,a.jsx)("span",{className:"w-6 text-center text-sm font-medium text-white",onClick:e=>e.stopPropagation(),children:eo}),(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:a=>{a.stopPropagation(),o(e,es.id,"add")},children:(0,a.jsx)(r.Plus,{className:"h-3 w-3"})})]})})]}),b&&f&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 p-1",children:[(0,a.jsx)(ee,{cardName:e.name,open:M,setOpen:S,userId:K?.id||"",collectionEntries:f.collectionEntries||[],variants:[{id:f.parentVariant.id,variantLabel:f.parentVariant.variantLabel||(f.parentVariant.variantNumber?.startsWith("OGS")||"Common"===f.parentVariant.rarity||"Uncommon"===f.parentVariant.rarity?"Normal":"Foil")},...f.children?.sort((e,a)=>{let r=e.variant.variantLabel||"",l=a.variant.variantLabel||"";return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)}).map(e=>({id:e.variant.id,variantLabel:e.variant.variantLabel||"Unknown"}))||[]],parentVariant:{variantLabel:f.parentVariant.variantNumber?.startsWith("OGS")||"Common"===f.parentVariant.rarity||"Uncommon"===f.parentVariant.rarity?"Normal":"Foil",rarity:f.parentVariant.rarity,prices:f.prices,cardmarketId:f.parentVariant.cardmarketId},childVariants:f.children?.sort((e,a)=>{let r=e.variant.variantLabel||"",l=a.variant.variantLabel||"";return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)}).map(e=>({variantLabel:e.variant.variantLabel||"Unknown",rarity:e.variant.rarity,prices:e.prices,cardmarketId:e.variant.cardmarketId}))||[]}),(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:()=>S(!0),children:(0,a.jsx)(n.Info,{className:"h-3 w-3"})}),(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:()=>{if(!f?.collectionEntries||!K?.id)return;let e=f.collectionEntries;if((e=>{if(!e||0===e.length||1===e.length)return!0;let a=e[0];return e.every(e=>e.language===a?.language&&e.condition===a?.condition&&e.gradingCompany===a?.gradingCompany&&e.gradeValue===a?.gradeValue&&e.gradeLabel===a?.gradeLabel&&e.notes===a?.notes)})(e)){let a=e.find(e=>e.quantity>0);if(a){let e=a.quantity-1;Z({userId:K.id,id:a.id,quantity:e})}}else S(!0)},children:(0,a.jsx)(l.Minus,{className:"h-3 w-3"})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"w-6 text-center text-md font-bold text-white",children:(f.parentVariant.userData?.quantity||0)+(f.children?.reduce((e,a)=>e+(a.variant.userData?.quantity||0),0)||0)})}),(0,a.jsx)(R,{cardName:e.name,open:C,setOpen:A,defaultQuantity:1,defaultVariantId:w||f.parentVariant.id,variants:[{id:f.parentVariant.id,variantLabel:f.parentVariant.variantNumber?.startsWith("OGS")||"Common"===f.parentVariant.rarity||"Uncommon"===f.parentVariant.rarity?"Normal":"Foil"},...f.children?.sort((e,a)=>{let r=e.variant.variantLabel||"",l=a.variant.variantLabel||"";return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)}).map(e=>({id:e.variant.id,variantLabel:e.variant.variantLabel}))||[]]}),"quick"===Y?(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),et(f.parentVariant.id)},children:(0,a.jsx)(r.Plus,{className:"h-3 w-3"})}):(0,a.jsxs)(er,{open:H,onOpenChange:X,children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",children:(0,a.jsx)(r.Plus,{className:"h-3 w-3"})})}),(0,a.jsxs)(el,{children:[(0,a.jsxs)(en,{className:"my-0.5 rounded-md p-1",onSelect:()=>{X(!1),T(f.parentVariant.id),"variant"===Y?et(f.parentVariant.id):A(!0)},children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Plus,{className:"h-5 w-5"})," ",f.parentVariant.variantNumber?.startsWith("OGS")||"Common"===f.parentVariant.rarity||"Uncommon"===f.parentVariant.rarity?"Normal":"Foil"]}),(0,a.jsx)("span",{className:"bg-accent rounded-md px-2 py-0.5 font-bold text-black",children:f.parentVariant.userData?.quantity||0})]}),f.children?.sort((e,a)=>{let r=e.variant.variantLabel||"",l=a.variant.variantLabel||"";return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)}).map(e=>(0,a.jsxs)(en,{className:"my-0.5 rounded-md p-1",onSelect:()=>{X(!1),T(e.variant.id),"variant"===Y?et(e.variant.id):A(!0)},children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Plus,{className:"h-5 w-5"})," ",e.variant.variantLabel||"Unknown"]}),(0,a.jsx)("span",{className:"bg-accent rounded-md px-2 py-0.5 font-bold text-black",children:e.variant.userData?.quantity||0})]},e.variant.id))]})]}),(0,a.jsx)(v.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-zinc-700",onClick:()=>{K?.id&&f?.parentVariant?.id&&J({userId:K.id,parentVariantId:f.parentVariant.id})},children:(0,a.jsx)(i.Heart,{className:`h-3 w-3 ${f.parentVariant.userData?.isWishlisted?"fill-red-500 text-red-500":""}`})})]}),b&&f&&(0,a.jsx)(Q,{cardName:e.name,open:$,onOpenChange:U,parentVariant:{variantLabel:f.parentVariant.variantNumber?.startsWith("OGS")||"Common"===f.parentVariant.rarity||"Uncommon"===f.parentVariant.rarity?"Normal":"Foil",rarity:f.parentVariant.rarity,prices:f.prices,cardmarketId:f.parentVariant.cardmarketId},childVariants:f.children?.sort((e,a)=>{let r=e.variant.variantLabel||"",l=a.variant.variantLabel||"";return"Foil"===r&&"Foil"!==l?-1:"Foil"!==r&&"Foil"===l?1:"Normal"===r&&"Normal"!==l?-1:"Normal"!==r&&"Normal"===l?1:r.localeCompare(l)}).map(e=>({variantLabel:e.variant.variantLabel||"Unknown",rarity:e.variant.rarity,prices:e.prices,cardmarketId:e.variant.cardmarketId}))||[]}),!p&&(0,a.jsx)(ex,{card:e,isOpen:F,onOpenChange:L,orientation:x,chosenVariant:h})]})}e.s(["default",()=>eg],125677)}]);